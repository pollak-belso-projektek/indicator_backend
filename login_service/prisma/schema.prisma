generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String        @id @default(uuid()) @db.Uuid
  email        String        @unique
  name         String?
  password     String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime?     @updatedAt
  alapadatokId String?       @db.Uuid
  permissions  Int           @default(0)
  isActive    Boolean       @default(true)

  tableAccess  TableAccess[]

  alapadatok   Alapadatok?   @relation("AlapadatokUsers", fields: [alapadatokId], references: [id])

  @@map("users")
}

model TableAccess {
  userId    String   @db.Uuid
  tableId   String    @db.Uuid
  access    Int       @default(0)
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  user      User?     @relation(fields: [userId], references: [id])
  table     TableList @relation(fields: [tableId], references: [id])

  @@id([userId, tableId])
  @@map("table_access")
}

model TableList {
  id        String    @id @default(uuid()) @db.Uuid
  name      String    @unique @db.VarChar(100)
  alias     String?    @db.VarChar(100)
  isAvailable Boolean   @default(true)
  isLocked   Boolean   @default(false)
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt

  access    TableAccess[]

  @@map("table_list")
}

model Alapadatok {
  id              String            @id @default(uuid()) @db.Uuid
  iskola_neve     String            @db.VarChar(150)
  intezmeny_tipus String            @db.VarChar(50)

  users           User[]            @relation("AlapadatokUsers")
}